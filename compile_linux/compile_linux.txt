# 1. 安装依赖 for x86_64 本机编译
apt --no-install-recommends install gcc make libncurses-dev flex bison libelf-dev libssl-dev
# 1. 安装依赖 for aarch64 交叉编译

# 2. 替换优化gcc （可选）

# 路线一：替换本机Ubuntu内核
# 1. 获取对应版本内核源码和config文件
# 源码：apt source linux-image-xxx;如果安装了mainline的，直接下载linux官方的就行
# config文件在 /boot/config-xxx
# 2. 编译
make menoconfig
# 关闭 FTRACE(如果要使用 -fomit-frame-pointer)
# 关闭 CONFIG_STACK_VALIDATION (如果替换gcc优化)
# 优化选项删除 -fstrict-aliasing -fmerge-all-constants
make -j8
make install

mv arch/x86/boot/bzImage /boot/vmlinuz
